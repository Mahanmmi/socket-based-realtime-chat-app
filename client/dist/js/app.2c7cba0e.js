(function(e){function t(t){for(var a,r,i=t[0],c=t[1],d=t[2],l=0,m=[];l<i.length;l++)r=i[l],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&m.push(s[r][0]),s[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(m.length)m.shift()();return o.push.apply(o,d||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,i=1;i<n.length;i++){var c=n[i];0!==s[c]&&(a=!1)}a&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},s={app:0},o=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var d=0;d<i.length;d++)t(i[d]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},1415:function(e,t,n){"use strict";n("e181")},"28f6":function(e,t,n){"use strict";n("4820")},4820:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("0cdd");var a=n("2b0e"),s=n("5f5b");n("ab8b"),n("2dd8");a["default"].use(s["a"]);var o,r,i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{height:"100vh"}},[n("notifications",{attrs:{group:"notif"}}),n("section",{staticStyle:{height:"100%"}},[n("ChatPanel",{staticStyle:{height:"100%"}})],1)],1)},c=[],d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("loading",{attrs:{active:e.isLoading,"is-full-page":!0},on:{"update:active":function(t){e.isLoading=t}}}),n("transition",{attrs:{"enter-active-class":"animate__animated animate__fadeIn","leave-active-class":"animate__animated animate__fadeOut",mode:"out-in"}},[e.user||e.isLoading?e._e():n("RegisterModal",{attrs:{"show-err":e.regErr},on:{sendRegister:e.register}})],1),n("transition",{attrs:{"enter-active-class":"animate__animated animate__fadeIn","leave-active-class":"animate__animated animate__fadeOut",mode:"out-in"}},[e.renameMode&&!e.isLoading?n("RenameModal",{attrs:{"show-err":e.regErr},on:{sendRename:e.sendRename,cancelRename:e.cancelRename}}):e._e()],1),n("transition",{attrs:{"enter-active-class":"animate__animated animate__fadeIn","leave-active-class":"animate__animated animate__fadeOut",mode:"out-in"}},[e.addRoomMode&&!e.isLoading?n("AddRoomModal",{attrs:{users:e.users},on:{sendAddRoom:e.sendAddRoom,cancelAddRoom:e.cancelAddRoom}}):e._e()],1),n("chat-window",{staticStyle:{height:"98%"},attrs:{currentUserId:e.currentUserId,rooms:e.rooms,roomId:e.roomId,messages:e.messages,theme:e.theme,menuActions:e.menuActions,messagesLoaded:e.messagesLoaded,loadingRooms:!1},on:{menuActionHandler:e.menuActionHandler,fetchMessages:e.fetchMessages,sendMessage:e.sendMessage,openFile:e.openFile,addRoom:e.addRoom}})],1)},u=[],l=(n("99af"),n("b0c0"),n("d3b7"),n("25f0"),n("b85c")),m=n("91b2"),f=n.n(m),g=(n("4768"),n("9062")),h=n.n(g),p=(n("e40d"),n("8e27")),v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"modal"},[n("div",{staticClass:"container"},[n("b",[e._v("Register")]),n("div",{staticClass:"flex-lg-wrap"},[e.showErr?n("p",{staticStyle:{color:"darkred","font-size":"smaller","text-align":"center"}},[e._v("Username already taken please choose another one")]):e._e(),n("div",{staticClass:"modal__title"},[n("label",{attrs:{for:"username"}},[e._v("Username:")]),n("b-form-input",{attrs:{id:"username",placeholder:"",type:"text"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1)]),n("div",{staticClass:"button_wrapper"},[n("b-button",{attrs:{variant:"success"},on:{click:e.doSend}},[e._v(" REGISTER! ")])],1)])])},b=[],_={name:"RegisterModal",data:function(){return{username:""}},props:{showErr:Boolean},methods:{doSend:function(){this.$emit("sendRegister",this.username),this.username=""}}},y=_,R=(n("5781"),n("2877")),M=Object(R["a"])(y,v,b,!1,null,"31dd6c34",null),w=M.exports,C=(n("fb6a"),n("a434"),n("3ca3"),n("ddb0"),n("2b3d"),n("cc1d")),S=1e4,j=void 0;function O(e,t){var n,a=Object(l["a"])(e.users);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(s._id===t)return s}}catch(o){a.e(o)}finally{a.f()}}function I(e){r.user=e.you,r.currentUserId=e.you.id,r.regErr=!1,r.users=e.users;var t,n=Object(l["a"])(e.users);try{for(n.s();!(t=n.n()).done;){var a=t.value,s={roomId:a.id,roomName:a.username,unreadCount:0,lastMessage:{content:""},users:[{_id:a.id,username:a.username},{_id:r.user.id,username:r.user.username}],typingUsers:[],messages:[]};r.rooms.push(s)}}catch(o){n.e(o)}finally{n.f()}r.isLoading=!1}function L(){r.isLoading=!1,r.regErr=!0,r.user=void 0}function x(e){var t=e;r.users.push(t);var n={roomId:t.id,roomName:t.username,unreadCount:0,lastMessage:{content:""},users:[{_id:t.id,username:t.username},{_id:r.user.id,username:r.user.username}],typingUsers:[],messages:[]};r.rooms.push(n),r.$notify({group:"notif",type:"success",text:"".concat(t.username," just joined the party!")})}function k(e){var t=e.from,n=e.room,a=e.content,s=r.findRoom(n),o=O(s,t),i=new Date,c={_id:s.roomId.toString()+s.messages.length.toString(),content:a,sender_id:o._id,username:o.username,date:"".concat(i.toDateString()),timestamp:"".concat(i.getHours(),":").concat(i.getMinutes()),saved:!0,distributed:!0,seen:!0,disable_actions:!0,disable_reactions:!0};s.lastMessage=c,s.messages.push(c),r.roomId!==s.roomId&&s.unreadCount++}function E(e){j={from:e.from,room:e.room,content:e.content,fileName:e.fileName,fileSize:e.fileSize,fileType:e.fileType,fileChunks:[]}}function U(e){if(j.fileChunks.push(e.slice),e.isEnded){var t=new Blob(j.fileChunks,{type:C.lookup(j.fileType)}),n=URL.createObjectURL(t),a={blob:t,localURL:n,name:j.fileName,size:j.fileSize,type:j.fileType},s=r.findRoom(j.room),o=O(s,j.from),i=new Date,c={_id:s.roomId.toString()+s.messages.length.toString(),content:j.content,sender_id:o._id,username:o.username,date:"".concat(i.toDateString()),timestamp:"".concat(i.getHours(),":").concat(i.getMinutes()),saved:!0,distributed:!0,seen:!0,disable_actions:!0,disable_reactions:!0,file:{name:a.name,size:a.size,type:a.type,url:a.localURL}};s.lastMessage=c,s.messages.push(c),r.roomId!==s.roomId&&s.unreadCount++}}function A(e){var t=r.user.username;r.user.username=e;var n,a=Object(l["a"])(r.rooms);try{for(a.s();!(n=a.n()).done;){var s,o=n.value,i=Object(l["a"])(o.users);try{for(i.s();!(s=i.n()).done;){var c=s.value;c.username===t&&(c.username=e)}}catch(f){i.e(f)}finally{i.f()}var d,u=Object(l["a"])(o.messages);try{for(u.s();!(d=u.n()).done;){var m=d.value;m.username===t&&(m.username=e)}}catch(f){u.e(f)}finally{u.f()}}}catch(f){a.e(f)}finally{a.f()}r.isLoading=!1,r.regErr=!1,r.renameMode=!1,r.$notify({group:"notif",type:"warn",text:"Username changed"})}function $(){r.isLoading=!1,r.regErr=!0}function z(e){var t,n=e.oldName,a=e.newName,s=Object(l["a"])(r.users);try{for(s.s();!(t=s.n()).done;){var o=t.value;o.username===n&&(o.username=a)}}catch(v){s.e(v)}finally{s.f()}var i,c=Object(l["a"])(r.rooms);try{for(c.s();!(i=c.n()).done;){var d,u=i.value,m=Object(l["a"])(u.users);try{for(m.s();!(d=m.n()).done;){var f=d.value;f.username===n&&(f.username=a,u.roomName===n&&2===u.users.length&&(u.roomName=a))}}catch(v){m.e(v)}finally{m.f()}var g,h=Object(l["a"])(u.messages);try{for(h.s();!(g=h.n()).done;){var p=g.value;p.username===n&&(p.username=a)}}catch(v){h.e(v)}finally{h.f()}}}catch(v){c.e(v)}finally{c.f()}r.$notify({group:"notif",type:"warn",text:"".concat(n," username changed to ").concat(a)})}function N(e){var t=e.name,n=e.selection;console.log(e),o.emit("joinroom",t);var a,s={roomId:t,roomName:t,unreadCount:0,users:[],typingUsers:[],messages:[]},i=Object(l["a"])(n);try{for(i.s();!(a=i.n()).done;){var c=a.value;s.users.push({_id:c.id,username:c.username})}}catch(d){i.e(d)}finally{i.f()}console.log(s.users),r.rooms.push(s)}function P(e){var t,n=e.username,a=e.id;for(var s in r.users)if(n===r.users[s].username){t=s;break}for(var o in r.users.splice(t,1),r.rooms)if(a===r.rooms[o].roomId){t=o;break}r.rooms.splice(t,1),r.$notify({group:"notif",type:"error",text:"".concat(n," left the party :(")})}function T(e,t){o=e,r=t,o.on("registered",(function(e){I(e)})),o.on("notregistered",(function(){L()})),o.on("joined",(function(e){x(e)})),o.on("message",(function(e){k(e)})),o.on("startfile",(function(e){E(e)})),o.on("receiveslice",(function(e){U(e)})),o.on("renamed",(function(e){A(e)})),o.on("notrenamed",(function(){$()})),o.on("sorenamed",(function(e){z(e)})),o.on("joinroom",(function(e){N(e)})),o.on("uleave",(function(e){P(e)})),o.on("notroom",(function(){r.$notify({group:"notif",type:"error",text:"Group name already taken"}),r.isLoading=!1,r.addRoomMode=!1})),o.on("doneroom",(function(){r.isLoading=!1,r.addRoomMode=!1}))}function D(e,t,n){var a=0;o.emit("filereceivestart",{from:r.currentUserId,target:e.roomId,content:t,fileName:n.name,fileSize:n.size,fileType:n.type});var s=!1;while(!s){var i=S*a;s=Math.min(S,n.size-i)===n.size-i;var c=n.blob.slice(i,i+Math.min(S,n.size-i));o.emit("receiveslice",{isEnded:s,slice:c}),a++}var d=new Blob([n.blob],{type:C.lookup(n.type)}),u=URL.createObjectURL(d),l=new Date,m={_id:e.roomId.toString()+e.messages.length.toString(),content:t,sender_id:r.currentUserId,username:r.user.username,date:"".concat(l.toDateString()),timestamp:"".concat(l.getHours(),":").concat(l.getMinutes()),saved:!0,distributed:!0,seen:!0,disable_actions:!0,disable_reactions:!0,file:{name:n.name,size:n.size,type:n.type,url:u}};e.lastMessage=m,e.messages.push(m),r.roomId!==e.roomId&&e.unreadCount++,r.isLoading=!1}var H,B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"modal"},[n("div",{staticClass:"container"},[n("b",[e._v("Change Username")]),n("div",{staticClass:"flex-lg-wrap"},[e.showErr?n("p",{staticStyle:{color:"darkred","font-size":"smaller","text-align":"center"}},[e._v("Username already taken please choose another one")]):e._e(),n("div",{staticClass:"modal__title"},[n("label",{attrs:{for:"username"}},[e._v("Username:")]),n("b-form-input",{attrs:{id:"username",placeholder:"",type:"text"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1)]),n("div",{staticClass:"button_wrapper"},[n("b-button",{attrs:{variant:"danger"},on:{click:e.cancelSend}},[e._v(" CANCEL ")]),n("b-button",{attrs:{variant:"success"},on:{click:e.doSend}},[e._v(" RENAME ")])],1)])])},F=[],G={name:"RenameModal",data:function(){return{username:""}},props:{showErr:Boolean},methods:{doSend:function(){this.$emit("sendRename",this.username),this.username=""},cancelSend:function(){this.username="",this.$emit("cancelRename")}}},J=G,W=(n("28f6"),Object(R["a"])(J,B,F,!1,null,"504245fa",null)),q=W.exports,K=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"modal"},[n("div",{staticClass:"container"},[n("b",[e._v("Choose members")]),n("div",{staticClass:"flex-lg-wrap"},[n("md-list",{staticClass:"md-scrollbar mylist"},e._l(e.users,(function(t,a){return n("md-list-item",{key:t.username},[n("span",{staticClass:"md-list-item-text"},[e._v(e._s(t.username))]),n("md-switch",{model:{value:e.selection[a].selected,callback:function(t){e.$set(e.selection[a],"selected",t)},expression:"selection[index].selected"}})],1)})),1),n("div",{staticClass:"modal__title"},[n("label",{attrs:{for:"groupname"}},[e._v("Group name:")]),n("b-form-input",{attrs:{id:"groupname",placeholder:"",type:"text"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)],1),n("div",{staticClass:"button_wrapper"},[n("b-button",{attrs:{variant:"danger"},on:{click:e.cancelSend}},[e._v(" CANCEL ")]),n("b-button",{attrs:{variant:"success"},on:{click:e.doSend}},[e._v(" CREATE ")])],1)])])},Q=[],V={name:"AddRoomModal",data:function(){return{name:"",selection:[]}},props:{users:Array},methods:{doSend:function(){this.$emit("sendAddRoom",this.name,this.selection),this.selection=[],this.name=""},cancelSend:function(){this.name="",this.selection=[],this.$emit("cancelAddRoom")}},mounted:function(){var e,t=Object(l["a"])(this.users);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.selection.push({username:n.username,id:n.id,selected:!1})}}catch(a){t.e(a)}finally{t.f()}}},X=V,Y=(n("1415"),Object(R["a"])(X,K,Q,!1,null,"c911a97c",null)),Z=Y.exports,ee={name:"ChatPanel",components:{AddRoomModal:Z,RenameModal:q,RegisterModal:w,ChatWindow:f.a,Loading:h.a},data:function(){return{isLoading:!0,renameMode:!1,addRoomMode:!1,user:void 0,regErr:!1,users:[],roomId:null,rooms:[],messages:[],currentUserId:void 0,messagesLoaded:!0,menuActions:[{name:"rename",title:"Change Username"}],theme:"dark"}},methods:{findRoom:function(e){var t,n=Object(l["a"])(this.rooms);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a.roomId===e)return a}}catch(s){n.e(s)}finally{n.f()}},register:function(e){this.isLoading=!0,H.emit("register",e)},sendRename:function(e){this.isLoading=!0,H.emit("rename",{old:this.user.username,username:e})},cancelRename:function(){this.renameMode=!1,this.regErr=!1},fetchMessages:function(e){var t=e.room;return this.messagesLoaded=!1,this.messages=t.messages,this.roomId=t.roomId,t.unreadCount=0,this.messagesLoaded=!0},sendMessage:function(e){var t=e.roomId,n=e.content,a=e.file,s=this.findRoom(t);if(a)this.isLoading=!0,D(s,n,a);else{H.emit("message",{from:this.currentUserId,target:t,content:n});var o=new Date,r={_id:t.toString()+s.messages.length.toString(),content:n,sender_id:this.currentUserId,username:this.user.username,date:"".concat(o.toDateString()),timestamp:"".concat(o.getHours(),":").concat(o.getMinutes()),saved:!0,distributed:!0,seen:!0,disable_actions:!0,disable_reactions:!0,file:a};s.messages.push(r),s.lastMessage=r}},openFile:function(e){var t=e.message,n=window.open(t.file.url,"_blank");n.focus(),console.log(t)},menuActionHandler:function(e){var t=e.action;"rename"===t.name&&(this.renameMode=!0)},sendAddRoom:function(e,t){var n,a=[],s=Object(l["a"])(t);try{for(s.s();!(n=s.n()).done;){var o=n.value;o.selected&&a.push(o)}}catch(r){s.e(r)}finally{s.f()}a.length?(this.isLoading=!0,a.push({id:this.currentUserId,username:this.user.username,selected:!0}),H.emit("addroom",{name:e,selection:a})):this.addRoomMode=!1},cancelAddRoom:function(){this.addRoomMode=!1},addRoom:function(){this.addRoomMode=!0}},mounted:function(){var e=this;this.isLoading=!0,H=Object(p["io"])("127.0.0.1:8778",{path:"/"}),H.on("connect",(function(){e.isLoading=!1})),T(H,this)}},te=ee,ne=Object(R["a"])(te,d,u,!1,null,"66e32879",null),ae=ne.exports,se={name:"App",components:{ChatPanel:ae}},oe=se,re=(n("034f"),Object(R["a"])(oe,i,c,!1,null,null,null)),ie=re.exports,ce=n("bc3a"),de=n.n(ce),ue=n("03a5"),le=n.n(ue),me=n("43f9"),fe=n.n(me),ge=n("77ed"),he=n.n(ge),pe=n("ee98"),ve=n.n(pe);n("c5c5"),n("51de"),n("e094");a["default"].prototype.$http=de.a,a["default"].config.productionTip=!1,a["default"].use(le.a),a["default"].use(ve.a),a["default"].use(he.a),a["default"].use(fe.a),new a["default"]({render:function(e){return e(ie)}}).$mount("#app")},5781:function(e,t,n){"use strict";n("8336")},8336:function(e,t,n){},"85ec":function(e,t,n){},e181:function(e,t,n){}});
//# sourceMappingURL=app.2c7cba0e.js.map